(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ec69634"],{"20d6":function(e,t,n){"use strict";var i=n("5ca1"),a=n("0a49")(6),r="findIndex",s=!0;r in[]&&Array(1)[r]((function(){s=!1})),i(i.P+i.F*s,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(r)},3606:function(e,t,n){var i=n("df24");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("499e").default;a("6d3e228d",i,!0,{})},"692c":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,"",""])},"7fbc":function(e,t,n){"use strict";n.r(t);n("cea6");var i=n("28a2"),a=(n("6762"),n("9865"),n("57e7"),n("20d6"),n("d25f"),n("96cf"),n("1da1")),r=(n("6d67"),n("c5f6"),n("7d9b")),s=n("ca00"),l=n("cd79"),o=n.n(l);function u(e){var t=c(),n=t.player;Object(s["k"])(t.msg)?alert(JSON.stringify(t.msg)):n.play({path:e,autoPlay:!0},(function(e,t){e||alert(JSON.stringify(t))}))}var c=function(){var e=null,t="";if(Object(s["i"])())try{if(e=window.api.require("videoPlayer"),Object(s["j"])(e))throw new Error("请首先加载videoPlayer模块")}catch(n){t="请首先加载videoPlayer模块"}else t="请在App环境下使用该功能";return{player:e,msg:t}},f={name:"UploadFile",components:{},props:{accept:{type:String,default:null},maxSize:{type:Number,default:31457280},maxCount:{type:Number,default:20},name:{type:String,default:""},showUpload:{type:Boolean,default:!0},uploadText:{type:String,default:"正在上传，请稍等"},multiple:{type:Boolean,default:!1},files:{type:Array,default:function(){return[]}},uploadSuccess:{type:Function,default:null,required:!1}},data:function(){return{fileList:[],isDisabled:!1,defaultVideoImg:o.a}},created:function(){this.init()},mounted:function(){this.showUpload&&this.requiredPermission()},methods:{init:function(){this.files.length>0&&(this.fileList=this.files.map((function(e){return{url:e.url,fileType:e.fileType,status:"done",message:""}})))},requiredPermission:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["c"])({code:"camera",name:"相机"});case 2:t=e.sent,t||this.$toast("由于您未授权,故不能使用相机");case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refresh:function(){this.fileList=[],this.isDisabled=!1},getUploadResult:function(){return this.fileList.filter((function(e){return"done"===e.status}))},onOversize:function(e){var t="文件大小不能超过".concat(this.maxSize/1024/1024,"M");this.$toast.fail(t)},beforeRead:function(e){return!0},afterRead:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,i,a,s,l,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("file",t),n=t.file,i=this.getFileType(n),a={url:"",status:"uploading",message:"正在上传中",fileType:i},this.fileList.push(a),s=new FormData,s.append("files[]",n),this.isDisabled=!0,e.prev=8,e.next=11,Object(r["c"])(s,i);case 11:l=e.sent,l.IsError?(this.$toast.fail(l.Message),a.status="failed",a.message="上传失败",o=this.fileList.findIndex((function(e){return e.url===a.url&&"failed"==e.status})),o>-1&&this.fileList.splice(o,1)):(a.status="done",a.message="上传成功",a.url=l.Data.AbsoluteUrl,console.log("this.fileList",this.fileList)),e.next=22;break;case 15:e.prev=15,e.t0=e["catch"](8),console.log("文件上传失败",e.t0),a.status="failed",a.message="上传失败",u=this.fileList.findIndex((function(e){return e.url===a.url&&"failed"==e.status})),u>-1&&this.fileList.splice(u,1);case 22:return e.prev=22,this.isDisabled=!1,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[8,15,22,25]])})));function t(t){return e.apply(this,arguments)}return t}(),getFileType:function(e){var t=0;return e.type.indexOf("video")>-1?t=1:e.type.indexOf("audio")>-1&&(t=3),t},removeFile:function(e){var t=this;this.$dialog.confirm({message:"您确认要删除该附件吗"}).then((function(){var n=t.fileList.findIndex((function(t){return t.url===e.url}));n>-1&&t.fileList.splice(n,1)})).catch((function(){}))},isImg:function(e){var t=["png","jpg","gif","bmp"],n="",i=e.lastIndexOf(".");return i>-1&&(n=e.substr(i+1)),t.includes(n)},imagePreview:function(e){Object(i["a"])({images:[e.url],showIndex:!1})},videoPlay:function(e){u(e.url)}}},d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-container"},[n("van-uploader",{attrs:{accept:e.accept,disabled:e.isDisabled,"max-size":e.maxSize,"max-count":e.maxCount,name:e.name,multiple:e.multiple,"show-upload":e.showUpload,"before-read":e.beforeRead,"after-read":e.afterRead},on:{oversize:e.onOversize}},[n("van-icon",{attrs:{name:"plus"}})],1),e._v(" "),e.fileList.length>0?n("ul",{staticClass:"upload-result"},e._l(e.fileList,(function(t,i){return n("li",{key:i,staticClass:"item"},["uploading"==t.status?n("div",{staticClass:"file-uploading"},[n("van-loading",{attrs:{size:"24px",vertical:""}},[e._v(e._s(t.message))])],1):n("div",[0==t.fileType?n("img",{attrs:{src:t.url},on:{click:function(n){return e.imagePreview(t)}}}):(t.fileType,n("img",{attrs:{src:e.defaultVideoImg},on:{click:function(n){return e.videoPlay(t)}}})),e._v(" "),n("van-icon",{staticClass:"close",attrs:{name:"clear"},on:{click:function(n){return e.removeFile(t)}}})],1)])})),0):e._e()],1)},p=[],m=n("2455");function h(e){n("3606")}var v=!1,b=h,x="data-v-68036e04",g=null,y=Object(m["a"])(f,d,p,v,b,x,g),w=y.exports,k={components:{UploadFile:w},props:{},data:function(){return{}},computed:{},created:function(){},mounted:function(){},watch:{},methods:{}},O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("\n    我是上次文件例子\n    "),n("Upload-File")],1)},_=[];function j(e){n("8281")}var L=!1,I=j,P="data-v-2ca722fa",z=null,F=Object(m["a"])(k,O,_,L,I,P,z);t["default"]=F.exports},8281:function(e,t,n){var i=n("692c");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("499e").default;a("73a558fd",i,!0,{})},9865:function(e,t,n){"use strict";var i=n("5ca1"),a=n("6821"),r=n("4588"),s=n("9def"),l=[].lastIndexOf,o=!!l&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(o||!n("2f21")(l)),"Array",{lastIndexOf:function(e){if(o)return l.apply(this,arguments)||0;var t=a(this),n=s(t.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,r(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}})},cd79:function(e,t,n){e.exports=n.p+"public/img/default-video.88b6f052.png"},df24:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,"\n.upload-container[data-v-68036e04] {\n  padding: 0.26667rem;\n}\n[data-v-68036e04] .van-uploader {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n[data-v-68036e04] .van-uploader .van-uploader__wrapper .van-uploader__input-wrapper {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  width: 2.13333rem;\n  height: 2.13333rem;\n  background-color: #fff;\n  border: 0.02667rem dashed #e5e5e5;\n}\n[data-v-68036e04] .van-uploader .van-uploader__wrapper .van-uploader__input-wrapper .van-icon {\n  font-size: 0.64rem;\n}\nul.upload-result[data-v-68036e04] {\n  margin-top: 0.26667rem;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n      -ms-flex-wrap: wrap;\n          flex-wrap: wrap;\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  width: 100%;\n}\nul.upload-result .item[data-v-68036e04] {\n  margin-right: 0.21333rem;\n  margin-bottom: 0.26667rem;\n  position: relative;\n  width: 2.13333rem;\n  height: 2.13333rem;\n  text-align: center;\n  border: 0.02667rem solid #e4e6f0;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\nul.upload-result .item img[data-v-68036e04] {\n  width: 2.13333rem;\n  height: 2.13333rem;\n}\nul.upload-result .item .close[data-v-68036e04] {\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n",""])}}]);